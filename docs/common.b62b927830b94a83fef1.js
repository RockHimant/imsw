(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"4iqE":function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var o=function(t){return t[t.ADD=0]="ADD",t[t.EDIT=1]="EDIT",t[t.READ_ONLY=2]="READ_ONLY",t[t.CLONE=3]="CLONE",t}({})},TwVa:function(t,n,e){},aKbQ:function(t,n,e){"use strict";e.d(n,"b",(function(){return f})),e.d(n,"a",(function(){return d}));var o=e("26FU"),r=e("K9Ia"),c=e("dzgT"),i=e("F/XL"),a=e("15JJ"),u=e("67Y/"),s=e("TYT/"),p=e("cUzu"),h=function(){return(h=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},f=function(){return function(){}}(),d=function(){function t(t){this.http=t,this.onContactSelected=new o.a(null),this.onUserUpdated=new r.a,this.onChatSelected=new o.a(null),this.onChatsUpdated=new r.a}return t.prototype.loadChatData=function(){var t=this;return Object(c.a)(this.getAllContacts(),this.getAllChats(),this.getCurrentUser(),(function(n,e,o){t.contacts=n,t.chats=e,t.user=o,t.onUserUpdated.next(o)}))},t.prototype.getChatByContact=function(t){var n=this;this.loadingCollection=!0;var e=this.user.chatInfo.find((function(n){return n.contactId===t}));return e?this.getAllChats().pipe(Object(a.a)((function(o){var r=o.find((function(t){return t.id===e.chatId})),c=n.contacts.find((function(n){return n.id===t}));return n.onChatSelected.next({chatCollection:r,contact:c}),n.loadingCollection=!1,Object(i.a)(r)}))):this.createChatCollection(t).pipe(Object(a.a)((function(e){return n.getChatByContact(t)})))},t.prototype.createChatCollection=function(t){var n=this,e=this.contacts.find((function(n){return n.id===t})),o=(1e9*Math.random()).toString(),r={id:o,chats:[]},c={chatId:o,lastChatTime:new Date,contactId:e.id,contactName:e.name,unread:null};return this.http.post("api/chat-collections",h({},r)).pipe(Object(a.a)((function(t){return n.user.chatInfo.push(c),n.updateUser(n.user).pipe(Object(a.a)((function(t){return n.getCurrentUser().pipe(Object(u.a)((function(t){n.user=t,n.onUserUpdated.next(t)})))})))})))},t.prototype.getAllContacts=function(){return this.http.get("api/contacts")},t.prototype.getAllChats=function(){return this.http.get("api/chat-collections")},t.prototype.getCurrentUser=function(){return this.http.get("api/chat-user").pipe(Object(u.a)((function(t){return t[0]})))},t.prototype.updateUser=function(t){return this.http.put("api/chat-user/"+t.id,h({},t))},t.prototype.updateChats=function(t,n){return this.http.put("api/chat-collections",{id:t,chats:n})},t.prototype.autoReply=function(t){var n=this;setTimeout((function(){n.onChatsUpdated.next(t)}),1500)},t.\u0275fac=function(n){return new(n||t)(s["\u0275\u0275inject"](p.c))},t.\u0275prov=s["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},mB2O:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var o=e("TYT/"),r=e("cUzu"),c=function(){function t(t){this.http=t}return t.prototype.getProducts=function(){return this.http.get("api/products")},t.\u0275fac=function(n){return new(n||t)(o["\u0275\u0275inject"](r.c))},t.\u0275prov=o["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()}}]);